<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Fédération de Judo - Culture & Progression</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- React & Lucide -->
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.292.0"
      }
    }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700;900&family=Noto+Serif+JP:wght@700&display=swap');
        
        body { font-family: 'Outfit', sans-serif; -webkit-tap-highlight-color: transparent; background-color: #f8fafc; }
        .font-serif-jp { font-family: 'Noto Serif JP', serif; }
        
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        @keyframes slideUpFade { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .animate-entry { animation: slideUpFade 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
    </style>
</head>
<body class="text-slate-800 h-screen overflow-hidden bg-slate-50">

    <div id="root" class="h-full w-full max-w-md mx-auto bg-white shadow-2xl overflow-hidden relative">
        <div class="flex items-center justify-center min-h-screen text-slate-300 animate-pulse font-bold tracking-widest">
            CHARGEMENT...
        </div>
    </div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            User, Users, Star, BookOpen, GraduationCap, Info, MapPin, Menu, X, 
            ArrowRight, ArrowLeft, Home, Award, Globe, Heart, Zap, Book, 
            ChevronRight, Shield, Smile, DoorOpen, Layout, Volume2, Search, Sparkles,
            Lock, CheckCircle2, Gavel, Target
        } from 'lucide-react';

        // ==================================================================================
        // 1. DONNÉES (STRUCTURE)
        // ==================================================================================

        const levels = [
            { id: 1, title: "PALIER 1", subtitle: "Entrer dans la voie", belts: "Blanche → Jaune", color: "from-amber-300 to-orange-400", theme: "amber", shadow: "shadow-orange-200", icon: <User size={32} /> },
            { id: 2, title: "PALIER 2", subtitle: "Comprendre", belts: "Jaune → Orange → Verte", color: "from-emerald-400 to-teal-500", theme: "emerald", shadow: "shadow-emerald-200", icon: <BookOpen size={32} /> },
            { id: 3, title: "PALIER 3", subtitle: "S’approprier", belts: "Bleue → Marron", color: "from-blue-500 to-indigo-600", theme: "blue", shadow: "shadow-blue-200", icon: <User size={32} /> },
            { id: 4, title: "PALIER 4", subtitle: "Transmettre", belts: "Ceinture Noire", color: "from-slate-700 to-slate-900", theme: "slate", shadow: "shadow-slate-300", icon: <Users size={32} /> },
            { id: 5, title: "PALIER 5", subtitle: "Guider", belts: "Hauts Gradés", color: "from-red-600 to-rose-700", theme: "red", shadow: "shadow-red-200", icon: <Star size={32} /> }
        ];

        const menuSections = [
            {
                title: "Mon attitude",
                color: "text-blue-900",
                items: [
                    { id: 'A', title: 'Le Dojo', image: 'images/dojo.jpeg', color: 'text-blue-600', items: [] },
                    { id: 'D', title: 'Code Moral', image: 'images/codemoral.jpeg', color: 'text-rose-600', items: [
                        { id: 'politesse', label: 'La Politesse' }, { id: 'courage', label: 'Le Courage' }, { id: 'sincerite', label: 'La Sincérité' }, { id: 'honneur', label: "L'Honneur" }, { id: 'modestie', label: 'La Modestie' }, { id: 'respect', label: 'Le Respect' }, { id: 'controle', label: 'Le Contrôle de Soi' }, { id: 'amitie', label: "L'Amitié" }
                    ]},
                    { id: 'H', title: "L'hygiène", image: 'images/lexique.jpeg', color: 'text-emerald-600', items: [] },
                    { id: 'S', title: 'Le salut', image: 'images/lesalut.png', color: 'text-indigo-600', items: [] }
                ]
            },
            {
                title: "Mes connaissances",
                color: "text-emerald-900",
                items: [
                    { id: 'E', title: 'Techniques', image: 'images/technique.jpeg', color: 'text-purple-600', items: [
                        { id: 'principes', label: 'Les Principes' }, { id: 'katas', label: 'Les Katas' }, { id: '100tech', label: 'Les 100 Techniques' }
                    ]},
                    { id: 'C', title: 'Histoire', image: 'images/culture.jpeg', color: 'text-emerald-600', items: [
                        { id: 'fondateur', label: 'Le Fondateur' }, { id: 'france', label: 'Judo en France' }, { id: 'monde', label: 'Judo dans le Monde' }, { id: 'champions_fr', label: 'Champions Français' }, { id: 'champions_etr', label: 'Champions Étrangers' }
                    ]},
                    { id: 'B', title: 'Grades', image: 'images/grades.jpeg', color: 'text-amber-600', items: [
                        { id: 'ceintures', label: 'Les Ceintures' }, { id: 'connaissance', label: 'Requis' }
                    ]},
                    { id: 'F', title: 'Lexique', image: 'images/lexique.jpeg', color: 'text-slate-600', items: [
                        { id: 'lexique_general', label: 'Vocabulaire' }
                    ]}
                ]
            },
            {
                title: "Ma pratique",
                color: "text-amber-900",
                items: [
                    { id: 'G1', title: 'La Sécurité', image: 'images/lasecurite.png', color: 'text-orange-600', items: [] },
                    { id: 'G2', title: 'Contrôle de soi', image: 'images/controledesoi.png', color: 'text-orange-600', items: [] },
                    { id: 'G3', title: "L'Arbitrage", image: 'images/arbitrage.png', color: 'text-orange-600', items: [] },
                    { id: 'G4', title: 'Mes Techniques', image: 'images/mestechniques.png', color: 'text-orange-600', items: [] }
                ]
            }
        ];

        const lexiconDatabase = {
            1: [
                { name: "Dojo", desc: "La salle où on étudie la voie (lieu de pratique)." },
                { name: "Judogi", desc: "La tenue du judoka (veste + pantalon)." },
                { name: "Obi", desc: "La ceinture." },
                { name: "Rei", desc: "Le salut." },
                { name: "Sensei", desc: "Le professeur (celui qui est né avant)." },
                { name: "Hajime", desc: "Commencez." },
                { name: "Mate", desc: "Arrêtez (pause)." },
                { name: "Soremade", desc: "Fin du combat ou de l'exercice." },
                { name: "Ippon", desc: "Victoire totale (10 points)." }
            ],
            2: [
                { name: "Tori", desc: "Celui qui fait l'action (attaque)." },
                { name: "Uke", desc: "Celui qui subit l'action (chute)." },
                { name: "Ukemi", desc: "Brise-chute (l'art de tomber sans se faire mal)." },
                { name: "Migi", desc: "Droite." },
                { name: "Hidari", desc: "Gauche." },
                { name: "Waza-ari", desc: "Gros avantage (presque la victoire)." },
                { name: "Osaekomi", desc: "Immobilisation." },
                { name: "Toketa", desc: "Sortie d'immobilisation." },
                { name: "Randori", desc: "Exercice libre (combat souple)." }
            ],
            3: [
                { name: "Kumikata", desc: "La garde (la saisie)." },
                { name: "Kuzushi", desc: "Le déséquilibre (1ère phase)." },
                { name: "Tsukuri", desc: "Le placement (2ème phase)." },
                { name: "Kake", desc: "La projection (3ème phase)." },
                { name: "Shiai", desc: "La compétition." },
                { name: "Tatami", desc: "Le tapis de judo." },
                { name: "Ayumi-ashi", desc: "Marche normale." },
                { name: "Tsugi-ashi", desc: "Marche glissée (pas chassés)." },
                { name: "Tai-sabaki", desc: "Gestion du corps (esquive/pivot)." }
            ],
            4: [
                { name: "Te-waza", desc: "Techniques de main." },
                { name: "Koshi-waza", desc: "Techniques de hanche." },
                { name: "Ashi-waza", desc: "Techniques de jambe." },
                { name: "Sutemi-waza", desc: "Techniques de sacrifice." },
                { name: "Ne-waza", desc: "Travail au sol." },
                { name: "Shime-waza", desc: "Etranglements." },
                { name: "Kansetsu-waza", desc: "Clés de bras." },
                { name: "Shido", desc: "Pénalité (faute légère)." },
                { name: "Hansoku-make", desc: "Disqualification." }
            ],
            5: [
                { name: "Seiryoku Zenyo", desc: "Le meilleur emploi de l'énergie." },
                { name: "Jita Kyoei", desc: "Entraide et prospérité mutuelle." },
                { name: "Shin-Gi-Tai", desc: "Esprit, Technique, Corps." },
                { name: "Zanshin", desc: "L'esprit de vigilance." },
                { name: "Sen-no-sen", desc: "Attaque dans l'attaque (initiative)." },
                { name: "Go-no-sen", desc: "Contre-attaque." },
                { name: "Kiai", desc: "L'union de l'énergie (le cri)." },
                { name: "Kata", desc: "Forme fondamentale." }
            ]
        };

        const getContent = (levelId, menuId, itemId) => {
            if (menuId === 'F') {
                let fullList = [];
                for (let i = 1; i <= levelId; i++) {
                    if (lexiconDatabase[i]) {
                        const wordsWithStatus = lexiconDatabase[i].map(word => ({
                            ...word,
                            isNew: i === levelId
                        }));
                        if (i === levelId) fullList = [...wordsWithStatus, ...fullList];
                        else fullList = [...fullList, ...wordsWithStatus];
                    }
                }
                fullList.sort((a, b) => (a.isNew === b.isNew) ? 0 : a.isNew ? -1 : 1);
                return {
                    title: `Lexique Palier ${levelId}`,
                    text: `Voici le vocabulaire que tu dois maîtriser à ce niveau.`,
                    list: fullList 
                };
            }

            if (levelId === 1) {
                if (menuId === 'A') return {
                    title: "Le Dojo",
                    text: "Le dojo est un lieu de respect où l'on apprend à se maîtriser.",
                    list: [
                        { name: "Tes chaussures", desc: "Je range mes chaussures avant de monter sur le tapis." },
                        { name: "Ton Judogi", desc: "Je croise bien la veste de mon judogi et je fais bien le nœud de ceinture." },
                        { name: "Le Silence", desc: "Je parle doucement sur un tapis de judo." }
                    ],
                    senseiMessage: "Le calme extérieur amène le calme intérieur."
                };

                if (menuId === 'H') return {
                    title: "L’hygiène",
                    text: "Prendre soin de soi, c'est respecter ses partenaires.",
                    list: [
                        { name: "Propreté", desc: "J’ai les pieds et les mains très propres." },
                        { name: "Sécurité", desc: "J’ai les ongles courts." },
                        { name: "Prudence", desc: "Je ne porte pas de bijoux (boucle d’oreilles, bracelet...)." }
                    ]
                };

                if (menuId === 'S') return {
                    title: "Le salut",
                    text: "Le salut marque le début et la fin de chaque échange.",
                    list: [
                        { name: "Entrée/Sortie", desc: "Je salue debout en montant sur le tatami." },
                        { name: "Au Sensei", desc: "Je salue à genoux mon professeur au début du cours." },
                        { name: "Au Partenaire", desc: "Je salue mon partenaire avant et après avoir travaillé avec lui (debout ou à genoux)." }
                    ],
                    magicPhrase: "« Je salue avant pour dire bonjour, après pour dire merci. »"
                };

                if (menuId === 'D') {
                    const codes = {
                        politesse: { t: "La Politesse", d: "C'est le respect d'autrui.", l: [{n:"Bonjour", d:"Dire bonjour en arrivant."}, {n:"Silence", d:"Ne pas couper la parole."}], m: "« La politesse coûte peu et achète tout. »" },
                        courage: { t: "Le Courage", d: "C'est faire ce qui est juste.", l: [{n:"Essayer", d:"Même si c'est dur."}, {n:"Se relever", d:"Se relever après une chute."}], m: "« J'ai peur, mais j'y vais quand même. »" },
                        sincerite: { t: "La Sincérité", d: "C'est s'exprimer sans déguiser sa pensée.", l: [{n:"Vérité", d:"Ne pas mentir au professeur."}], m: "« Je ne triche ni avec les autres, ni avec moi-même. »" },
                        honneur: { t: "L'Honneur", d: "C'est être fidèle à la parole donnée.", l: [{n:"Dignité", d:"Gagner sans se moquer, perdre sans pleurer."}], m: "« Ma parole est aussi solide que ma ceinture. »" },
                        modestie: { t: "La Modestie", d: "C'est parler de soi-même sans orgueil.", l: [{n:"Simplicité", d:"Ne pas se vanter."}], m: "« Plus je suis fort, plus je suis gentil. »" },
                        respect: { t: "Le Respect", d: "Sans respect, aucune confiance ne peut naître.", l: [{n:"Les Autres", d:"Accepter tout le monde."}], m: "« Respecter, c'est grandir ensemble. »" },
                        controle: { t: "Le Contrôle de Soi", d: "C'est savoir se taire quand monte la colère.", l: [{n:"Calme", d:"Rester calme même si on perd."}], m: "« Le plus fort est celui qui maîtrise sa colère. »" },
                        amitie: { t: "L'Amitié", d: "C'est le plus pur des sentiments humains.", l: [{n:"Entraide", d:"Aider les copains."}], m: "« Un ami sur le tatami est un ami pour la vie. »" }
                    };
                    const c = codes[itemId];
                    if (c) return { 
                        title: c.t, 
                        text: c.d, 
                        list: c.l.map(x => ({name: x.n, desc: x.d})),
                        magicPhrase: c.m
                    };
                }

                if (menuId === 'G1') return {
                    title: "La sécurité",
                    text: "Je respecte les règles pour que tout le monde soit en sécurité.",
                    list: [
                        { name: "Attention", desc: "Je contrôle la chute de mon partenaire pour qu’il ne se fasse pas mal" },
                        { name: "Calme", desc: "Je ne m’énerve pas si je ne sais pas bien faire une technique" },
                        { name: "Interdiction", desc: "Je n’ai pas le droit de frapper" }
                    ]
                };

                if (menuId === 'G2') return {
                    title: "Le contrôle de soi",
                    text: "Maîtriser son corps et son esprit face aux autres.",
                    list: [
                        { name: "Courage", desc: "Je n’ai pas peur de combattre avec un camarade" },
                        { name: "Respect", desc: "Je ne me moque pas de ceux qui sont moins forts que moi" },
                        { name: "Acceptation", desc: "Durant les combats, j’accepte de tomber et je m’applique en faisant la chute" }
                    ]
                };

                if (menuId === 'G3') return {
                    title: "L'arbitrage",
                    text: "Je connais les règles de base du combat.",
                    list: [
                        { name: "Les scores", desc: "Je sais reconnaître un ippon et un waza ari" },
                        { name: "Les gestes", desc: "Je connais le geste de l’arbitre quand il dit ippon ou waza ari" },
                        { name: "Départ", desc: "Hajime" },
                        { name: "Commandes", desc: "Je sais dire arrête un combat , Matté et je sais dire fin d’un combat , Sore Made" }
                    ]
                };

                if (menuId === 'G4') return {
                    title: "Les techniques que je sais faire",
                    text: "Voici les techniques fondamentales que je commence à maîtriser.",
                    list: [
                        { name: "Debout", desc: "o soto gari" },
                        { name: "Au sol", desc: "hon gesa gatame" },
                        { name: "Mouvement", desc: "hiza guruma..." }
                    ]
                };
            }

            return {
                title: "En construction",
                text: `Le contenu détaillé pour ce niveau est en cours de déploiement.`
            };
        };

        const App = () => {
            const [selectedLevel, setSelectedLevel] = useState(null);
            const [showObjectives, setShowObjectives] = useState(false); 
            const [selectedMenu, setSelectedMenu] = useState(null);
            const [selectedItem, setSelectedItem] = useState(null);
            const [isSpeaking, setIsSpeaking] = useState(false);

            const themeTextMap = {
                amber: 'text-amber-600',
                emerald: 'text-emerald-600',
                blue: 'text-blue-600',
                slate: 'text-slate-600',
                red: 'text-red-600'
            };

            const themeBgMap = {
                amber: 'bg-amber-600',
                emerald: 'bg-emerald-600',
                blue: 'bg-blue-600',
                slate: 'bg-slate-700',
                red: 'bg-red-600'
            };

            const toggleSpeech = (text) => {
                if (!('speechSynthesis' in window)) return;
                window.speechSynthesis.cancel();
                if (isSpeaking) {
                    setIsSpeaking(false);
                } else {
                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.lang = 'fr-FR'; 
                    utterance.onend = () => setIsSpeaking(false);
                    window.speechSynthesis.speak(utterance);
                    setIsSpeaking(true);
                }
            };

            const goBack = () => {
                setIsSpeaking(false);
                window.speechSynthesis.cancel();
                if (selectedItem) {
                    setSelectedItem(null);
                    if (selectedMenu && (['F', 'A', 'H', 'S'].includes(selectedMenu.id) || selectedMenu.id.startsWith('G'))) {
                        setSelectedMenu(null);
                    }
                }
                else if (selectedMenu) setSelectedMenu(null);
                else if (showObjectives) setShowObjectives(false);
                else if (selectedLevel) setSelectedLevel(null);
            };

            const renderVideoElement = (videoPath) => {
                if (!videoPath) return null;
                const isLocal = videoPath.toLowerCase().endsWith('.mp4') || videoPath.toLowerCase().endsWith('.mov');
                const type = videoPath.toLowerCase().endsWith('.mov') ? 'video/quicktime' : 'video/mp4';
                return (
                    <div className="mt-4 rounded-2xl overflow-hidden shadow-sm aspect-video bg-black">
                        {isLocal ? (
                            <video controls className="w-full h-full">
                                <source src={videoPath} type={type} />
                            </video>
                        ) : (
                            <iframe width="100%" height="100%" src={`https://www.youtube.com/embed/${videoPath}`} title="Video" frameBorder="0" allowFullScreen></iframe>
                        )}
                    </div>
                );
            };

            // VUE 1 : ACCUEIL
            if (!selectedLevel) return (
                <div className="flex flex-col h-full bg-white animate-entry">
                    <header className="px-6 pt-10 pb-6 flex justify-between items-center bg-white sticky top-0 z-10">
                        <div>
                            <h1 className="text-3xl font-black text-slate-900 tracking-tighter">JUDO<span className="text-red-600">CULTURE</span></h1>
                            <p className="text-slate-400 text-sm font-medium uppercase tracking-widest">Guide de Progression</p>
                        </div>
                        <div className="w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center text-slate-600">
                            <Menu size={20} />
                        </div>
                    </header>
                    <main className="flex-1 overflow-y-auto px-6 pb-12 no-scrollbar space-y-6 mt-4">
                        {levels.map((level, index) => (
                            <button 
                                key={level.id} 
                                onClick={() => {
                                    setSelectedLevel(level);
                                    if (level.id === 1) setShowObjectives(true);
                                }} 
                                className={`w-full group relative overflow-hidden rounded-[2.5rem] p-6 text-left transition-all duration-300 active:scale-95 animate-entry`} 
                                style={{ animationDelay: `${index * 100}ms` }}
                            >
                                <div className={`absolute inset-0 bg-gradient-to-br ${level.color} opacity-90 transition-opacity`}></div>
                                <div className="relative z-10 flex justify-between items-center text-white">
                                    <div>
                                        <span className="inline-block px-3 py-1 bg-white/20 backdrop-blur-md rounded-full text-[10px] font-bold uppercase tracking-widest mb-2 border border-white/10">{level.belts}</span>
                                        <h2 className="text-3xl font-black italic uppercase leading-none mb-1">{level.title}</h2>
                                        <p className="font-medium text-white/90">{level.subtitle}</p>
                                    </div>
                                    <div className="bg-white/20 p-3 rounded-2xl backdrop-blur-sm border border-white/10">{level.icon}</div>
                                </div>
                            </button>
                        ))}
                    </main>
                </div>
            );

            // VUE 1.5 : ÉCRAN OBJECTIFS (POUR PALIER 1)
            if (selectedLevel && showObjectives) return (
                <div className="flex flex-col h-full bg-white animate-entry">
                    <header className="px-6 pt-10 pb-6 flex justify-between items-center bg-white sticky top-0 z-10">
                        <button onClick={goBack} className="w-10 h-10 flex items-center justify-center rounded-full bg-slate-50 text-slate-900">
                            <ArrowLeft size={20}/>
                        </button>
                        <span className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Introduction</span>
                    </header>
                    <main className="flex-1 px-8 flex flex-col justify-center pb-12">
                        <div className={`bg-gradient-to-br ${selectedLevel.color} p-10 rounded-[3rem] shadow-xl shadow-${selectedLevel.theme}-100 mb-10 relative overflow-hidden`}>
                            <div className="absolute -top-6 -right-6 text-white opacity-20">
                                <Target size={120} />
                            </div>
                            <h3 className="text-xs font-black text-white uppercase tracking-[0.2em] mb-6 flex items-center gap-2">
                                <Sparkles size={14} /> Tes Objectifs
                            </h3>
                            <p className="text-2xl font-bold text-white leading-snug relative z-10">
                                « À la fin de ce chapitre, je serai capable de chuter, de projeter, de contrôler au sol ou de combattre sans avoir peur et sans faire mal. Je montrerai du respect à mon partenaire et je me comporterai comme un judoka »
                            </p>
                        </div>
                        <button 
                            onClick={() => setShowObjectives(false)}
                            className="w-full bg-slate-900 text-white py-6 rounded-full font-black text-xl shadow-xl shadow-slate-200 active:scale-95 transition-transform flex items-center justify-center gap-3"
                        >
                            COMMENCER <ArrowRight size={24} />
                        </button>
                    </main>
                </div>
            );

            // VUE 2 : MENU
            if (selectedLevel && !selectedMenu) return (
                <div className="flex flex-col h-full bg-slate-50 animate-entry">
                    <div className="px-6 pt-10 pb-8 bg-white rounded-b-[3rem] shadow-sm z-10">
                        <button onClick={goBack} className="flex items-center text-slate-400 hover:text-slate-800 mb-6 font-bold text-xs uppercase tracking-[0.2em]">
                            <ArrowLeft size={16} className="mr-2"/> Retour
                        </button>
                        <h2 className="text-4xl font-black text-slate-900 leading-none mb-2">{selectedLevel.title}</h2>
                        <p className="text-slate-500 font-medium">{selectedLevel.subtitle}</p>
                    </div>
                    <main className="flex-1 overflow-y-auto px-6 py-6 no-scrollbar space-y-8">
                        {menuSections.map((section, idx) => (
                            <div key={idx}>
                                <h3 className={`font-black text-lg mb-4 tracking-tight uppercase ${section.color}`}>{section.title}</h3>
                                <div className="grid grid-cols-2 gap-4">
                                    {section.items.map((menu, index) => (
                                        <button key={menu.id} onClick={() => {
                                            setSelectedMenu(menu);
                                            if (['F', 'A', 'H', 'S'].includes(menu.id) || menu.id.startsWith('G')) {
                                                setSelectedItem({ id: 'direct_access' });
                                            }
                                        }} className="bg-white p-5 rounded-[1.5rem] shadow-sm flex flex-col justify-between aspect-square hover:shadow-md transition-all active:scale-95 animate-entry" style={{ animationDelay: `${index * 50}ms` }}>
                                            <div className="flex flex-col h-full">
                                                <div className="flex-1 w-full rounded-xl overflow-hidden mb-3 relative shadow-sm">
                                                    <img src={menu.image} alt={menu.title} className="w-full h-full object-cover" />
                                                </div>
                                                <div className="flex justify-between items-center">
                                                    <span className={`text-lg font-bold ${menu.color} leading-tight text-left`}>{menu.title}</span>
                                                </div>
                                            </div>
                                        </button>
                                    ))}
                                </div>
                            </div>
                        ))}
                    </main>
                </div>
            );

            // VUE 3 : SOUS-MENU
            if (selectedMenu && !selectedItem) return (
                <div className="flex flex-col h-full bg-white animate-entry">
                    <header className="px-6 pt-10 pb-8 bg-slate-50 rounded-b-[3rem]">
                        <button onClick={goBack} className="flex items-center text-slate-400 mb-6 font-bold text-xs uppercase tracking-widest"><ArrowLeft size={16} className="mr-2"/> Retour</button>
                        <h2 className="text-3xl font-black text-slate-900 leading-tight">{selectedMenu.title}</h2>
                    </header>
                    <main className="flex-1 overflow-y-auto px-6 py-8 no-scrollbar space-y-3">
                        {selectedMenu.items.map((item, index) => (
                            <button key={item.id} onClick={() => setSelectedItem(item)} className="w-full p-6 rounded-[2rem] bg-white border border-slate-100 flex items-center justify-between group active:bg-slate-50 transition-colors animate-entry shadow-sm" style={{ animationDelay: `${index * 50}ms` }}>
                                <span className="font-bold text-slate-700 text-lg">{item.label}</span>
                                <div className={`w-10 h-10 rounded-full bg-slate-50 text-slate-300 flex items-center justify-center group-hover:bg-slate-100 group-hover:${themeTextMap[selectedLevel.theme]} transition-all`}><ChevronRight size={20}/></div>
                            </button>
                        ))}
                    </main>
                </div>
            );

            // VUE 4 : CONTENU
            if (selectedItem) {
                const content = getContent(selectedLevel.id, selectedMenu.id, selectedItem.id);
                const themeColorClass = themeTextMap[selectedLevel.theme] || 'text-red-600';
                const themeBgClass = themeBgMap[selectedLevel.theme] || 'bg-red-600';

                return (
                    <div className="flex flex-col h-full bg-white animate-entry">
                        <header className="px-6 pt-10 pb-4 flex justify-between items-center bg-white sticky top-0 z-20">
                            <button onClick={goBack} className="w-10 h-10 flex items-center justify-center rounded-full bg-slate-50 text-slate-900"><ArrowLeft size={20}/></button>
                            <button onClick={() => toggleSpeech(content.text)} className={`w-10 h-10 rounded-full flex items-center justify-center transition-all ${isSpeaking ? `${themeBgClass} text-white animate-pulse` : 'bg-slate-50 text-slate-400'}`}><Volume2 size={20}/></button>
                        </header>
                        <main className="flex-1 overflow-y-auto px-8 pb-16 animate-entry no-scrollbar">
                            <div className="flex items-center gap-2 mb-4">
                                <span className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">{selectedLevel.title}</span>
                                <div className="w-1 h-1 bg-slate-300 rounded-full"></div>
                                <span className={`text-[10px] font-bold ${themeColorClass} uppercase tracking-widest`}>{selectedMenu.title}</span>
                            </div>
                            <h2 className="text-4xl font-black text-slate-900 mb-8 leading-tight">{content.title}</h2>
                            <div className="space-y-8">
                                {content.text && <p className="text-xl text-slate-600 font-medium leading-relaxed">{content.text}</p>}
                                {content.list && (
                                    <ul className="space-y-4">
                                        {content.list.map((c, i) => (
                                            <li key={i} className="p-6 rounded-[2rem] border bg-slate-50 border-slate-50">
                                                <span className="font-black text-xl text-slate-900 block mb-2">{c.name}</span>
                                                <p className="text-slate-500 font-medium">{c.desc}</p>
                                                {c.video && renderVideoElement(c.video)}
                                                {c.image && <div className="mt-4 rounded-2xl overflow-hidden shadow-sm"><img src={c.image} alt={c.name} className="w-full h-auto object-cover" /></div>}
                                            </li>
                                        ))}
                                    </ul>
                                )}
                                {content.magicPhrase && (
                                    <div className="relative p-8 rounded-[2.5rem] bg-slate-900 text-white shadow-xl">
                                        <div className="absolute top-0 right-0 p-4 opacity-10"><Sparkles size={60} /></div>
                                        <h5 className={`text-[10px] font-bold uppercase tracking-[0.3em] ${themeColorClass} mb-4`}>Phrase Magique</h5>
                                        <p className="text-2xl font-serif-jp italic font-black">"{content.magicPhrase}"</p>
                                    </div>
                                )}
                                {content.senseiMessage && (
                                    <div className={`p-8 rounded-[2.5rem] ${themeBgClass} text-white shadow-xl flex gap-4`}>
                                        <div className="bg-white/20 p-2 rounded-xl h-fit"><Info size={20} /></div>
                                        <div>
                                            <h5 className="text-[10px] font-bold uppercase tracking-widest text-white/60 mb-2">Le mot du Sensei</h5>
                                            <p className="text-lg font-bold leading-tight">"{content.senseiMessage}"</p>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </main>
                    </div>
                );
            }
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>